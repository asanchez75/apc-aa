<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Alerts</title><meta name="generator" content="DocBook XSL Stylesheets V1.49"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="article"><div class="titlepage"><div><h2 class="title"><a name="d0e1"></a>Alerts</h2></div><div><div class="author"><h3 class="author">Jakub Ad&aacute;mek</h3><div class="affiliation"><span class="orgname">Econnect<br></span></div></div></div><div><p class="releaseinfo">$Id$</p></div><div><div class="revhistory"><table border="1" width="100%" summary="Revision history"><tr><th align="left" valign="top" colspan="2"><b>Revision History</b></th></tr><tr><td align="left">Revision 1.0</td><td align="left">5.4.2003</td></tr><tr><td align="left" colspan="2">Extracted from the <a href="reader.html" target="_top">Reader
        Management</a> document and enhanced.</td></tr></table></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><a href="#d0e43">Introduction</a></dt><dt><a href="#d0e53">Email content</a></dt><dd><dl><dt><a href="#d0e63">View Type Alerts Selection Set</a></dt></dl></dd><dt><a href="#d0e99">Alerts module</a></dt><dt><a href="#d0e215">Sending emails</a></dt><dt><a href="#d0e239">Step by step tutorial</a></dt><dt><a href="#d0e409">Tips</a></dt></dl></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p><span class="emphasis"><em>This file was created from the DocBook XML source. Please
    do modifications in the source, not here.</em></span></p></div><div class="abstract"><p><b>Abstract</b></p><p>This document describes the Alerts module. It is necessary you
    understand how readers are managed by the <a href="reader.html" target="_top">Reader Management slices</a> first.</p></div><div class="sect1"><div class="titlepage"><div><h2 class="title" style="clear: both"><a name="d0e43"></a>Introduction</h2></div></div><p>AA Alerts are designed to deliver new AA items to users by e-mail.
    Slice Administrators choose the design and which kind of items from which
    slices to include. Readers subscribe for receiving the news and select how
    often: immediately when the news becomes Active (in the meaning of the
    bins in Item Manager) or a daily, weekly or monthly digest.</p><p>Anonymous forms (see <a href="anonym.html" target="_top">doc</a>)
    allow users to change their subscriptions. Users are identified by e-mail
    and they must confirm their e-mail address by a confirmation code received
    by e-mail to make sure the address is working.</p></div><div class="sect1"><div class="titlepage"><div><h2 class="title" style="clear: both"><a name="d0e53"></a>Email content</h2></div></div><p>This section describes how are chosen the new items which appear in
    the email.</p><p>One Alerts module is one email from the reader's point of view.
    A set of Selections is assigned to the module. The Selections are defined
    in views of type &#8220;Alerts Selection Set&#8221;.</p><div class="sect2"><div class="titlepage"><div><h3 class="title"><a name="d0e63"></a>View Type &#8220;Alerts Selection Set&#8221;</h3></div></div><p>You define this view in the slices, from which you want to send
      new items. The first check box, &#8220;Group by selections&#8221;, will
      be explained later. The view defines the Selections, which have a
      description and a set of the powerful <a href="???" target="_top"><tt>conds[]</tt>
      and <tt>sort[]</tt></a> parameters, the same as are used
      with <tt>slice.php3</tt> in search forms. You can e.g.
      create one selection for each category. When you open an Alerts view,
      there are always two empty pairs of boxes for two new Selections. If you
      want to define more Selections, store the view settings and reopen it.</p><p>You can add Selections from several views and several slices to
      one Alerts module. Readers may choose which selections they want to
      receive. Some items may pass the <tt>conds[]</tt> conditions
      of several Selections. If you check &#8220;Group by selections&#8221;,
      the view is generated for each Selection and some items may appear
      several times in the email. If you leave &#8220;Group by selections&#8221;
      unchecked, first all items which pass the reader's Selections are
      collected and the view is generated only once for all of them. </p><p>The setting &#8220;Fulltext URL&#8221; links to the page where is
      an item viewed when the reader clicks on its headline in the email. Of
      course if you do not add a linked headline to the view design, this
      setting is not used.</p></div></div><div class="sect1"><div class="titlepage"><div><h2 class="title" style="clear: both"><a name="d0e99"></a>Alerts module</h2></div></div><p>The Alerts module appears like other regular modules in the slice
    select box. It offers these pages:</p><div class="table"><p><b>Table 1. Alerts menu</b></p><table summary="Alerts menu" border="1"><colgroup><col><col></colgroup><tbody><tr><td>Settings</td><td>Core settings for the Alerts module, see below.</td></tr><tr><td>Selections</td><td>Choose which selections you want to show and their order.
            Selections are defined in views of type Alerts Selection Set in
            the slices from which you want to send new items. Each selection
            has a description and a set of the Mind that if some item appears
            in several selections, it will be repeated in the mail. Try to
            make selections mutually exclusive.</td></tr><tr><td>Send emails</td><td>You can manually send the digest to all readers. And you
            can send an example email to yourself to see exactly what readers
            receive.</td></tr><tr><td>Reader Management</td><td>Sets the Reader Management Slice which feeds this Alerts.
            Allows to add, delete and refresh the Alerts-specific fields to
            the slice. When you change the list on the Selections page, use
            Sync to refresh the appropriate constant group in the Reader
            Management Slice.</td></tr><tr><td>Email Templates</td><td>Allows to edit all email templates.</td></tr></tbody></table></div><p>The fields added by Sync with reader slice are:</p><div class="table"><p><b>Table 2. Alerts specific fields</b></p><table summary="Alerts specific fields" border="1"><colgroup><col><col></colgroup><tbody><tr><td>how often</td><td>How often the reader receives a digest: instant (each new
            item in one e-mail), daily, weekly, monthly.</td></tr><tr><td>choose selections</td><td>Multiple checkboxes allowing to choose which selections
            from the collection the reader wants to read. New parameters of
            the Multiple Checkboxes field Input type allow to view them in a
            table, see the Parameter Wizard.</td></tr></tbody></table></div><p>You may show <span class="emphasis"><em>how often</em></span> or <span class="emphasis"><em>choose
    selections </em></span>in the anonymous forms or you may set defaults by
    hidden fields.</p><p>The core settings in Alerts Admin - Settings include these special
    fields:</p><div class="table"><p><b>Table 3. Alerts Settings</b></p><table summary="Alerts Settings" border="1"><colgroup><col><col></colgroup><tbody><tr><td>form URL</td><td>The URL to your pages with the &#8220;Change personal
            details&#8221; form. This URL is used to create the
            <tt>_#COLLFORM</tt> alias.</td></tr><tr><td>welcome email</td><td>A link to the email template for a message sent to new
            users on subscription. The edit icon on the right allows you to
            jump to the email edit form.</td></tr><tr><td>alert email</td><td>A link to the email template of the alert sent instant /
            daily / ... and containing new items.</td></tr></tbody></table></div><p>The email templates (welcome and alert) are stored in the common
    table <tt>email</tt> and are defined using aliases and alias
    functions. This allows a completely free design. The formatted new items
    are added by the <tt>_#FILTERS_</tt> alias. If you want to
    send different texts to readers with different &#8220;how often&#8221;,
    use the <tt>switch</tt> function on the alias
    <tt>_#HOWOFTEN</tt>. To allow readers to confirm their email
    and change their personal settings, use the alias <tt>_#COLLFORM</tt>,
    which is the URL you filled in Alerts Admin - Settings, with an additional
    9 letters parameter containing the <a href="#">access code</a>.</p><p>An example of both email types is added by <tt>sql_update</tt>.</p></div><div class="sect1"><div class="titlepage"><div><h2 class="title" style="clear: both"><a name="d0e215"></a>Sending emails</h2></div></div><p>There are two ways of sending the emails: regularly by cron or
    manually.</p><p>The cron items are added to the <tt>cron</tt> table
    automatically by <tt>sql_update.php3</tt>. You must set up
    cron on your server, <a href="http://apc-aa.sourceforge.net/faq#cron" target="_top">see
    FAQ</a>. There are four items for the four different frequencies
    (instant, daily, weekly, monthly). The info when were which Alerts module
    emails generated is stored in the table <tt>alerts_collection_howoften</tt>.
    The emails are created so that readers see the HTML version in e-mail
    clients supporting HTML and the text version in clients supporting text
    only. The text form is created by deleting all HTML tags. Technically
    speaking, it is a MIME multi-part/alternative message with a text part and
    a HTML part. </p><p>If you want to send emails manually, use the &#8220;Send emails&#8221;
    page in the Alerts module. </p></div><div class="sect1"><div class="titlepage"><div><h2 class="title" style="clear: both"><a name="d0e239"></a>Step by step tutorial</h2></div></div><p>Here is a tutorial, describing in steps how you can try the Alerts
    module. The result does not use Authorization, the personal info is
    protected by a password.</p><div class="orderedlist"><ol type="1"><li>Update to the new AA version from CVS and run
        <tt>sql_update.php3</tt></li><li><p>Create &#8220;My Readers&#8221;:</p><div class="orderedlist"><ol type="a"><li>Create a new slice from the &#8220;Reader Management
            Minimal&#8221; template with the name &#8220;My Readers&#8221;</li><li>Set &#8220;Allow anonymous posting&#8221; to
            &#8220;Active&#8221;</li><li>Set &#8220;Allow anonymous editing&#8221; to
            &#8220;All items&#8221;</li></ol></div></li><li><p>Create selections:</p><div class="orderedlist"><ol type="a"><li>In your favorite test slice, create a view with type
            &#8220;Alerts Digest&#8221;. Fill something intelligent into the
            design, particularly the &#8220;Odd Rows&#8221; field</li><li>Fill the Selection 1 and 2 Description with
            &#8220;My Selection 1&#8221; and 2. Do not fill
            <tt>conds[]</tt>, you can play with them when you are
            an Alerts-master</li></ol></div></li><li><p>Create and set Alerts:</p><div class="orderedlist"><ol type="a"><li>Create a new Alerts module</li><li>Fill the name &#8220;My Alerts&#8221;. Fill the form URL
            with some web folder to which you have access, e.g.
            <tt>http://have_access_to/myalerts.shtml</tt></li><li>Click on Selections and insert My Selection 1 and 2 into
            the Alerts</li><li>Click on Sync with reader slice, change to My Readers</li><li>Click on Add or refresh fields. A message &#8220;2
            field(s) added&#8221; appears.</li></ol></div></li><li><p>Create the anonymous form:</p><div class="orderedlist"><ol type="a"><li>Move to My Readers</li><li>In Slice Admin - Fields uncheck Show for Username and
            check Required for Email (<span class="emphasis"><em>this is not default because
            the template serves both for Alerts combined with Auth and for
            standalone Alerts</em></span>)</li><li>Choose Slice Admin - Anonymous Form Wizard</li><li>Fill the URL similar to <tt>http://have_access_to/myalerts.shtml</tt></li><li>Uncheck all fields except of Email, Password, How often
            and Selections</li><li>Click on Show form and copy the form HTML to the file
            <tt>http://have_access_to/myalerts.shtml</tt></li></ol></div></li><li><p>Subscribe to Alerts:</p><div class="orderedlist"><ol type="a"><li><p>Go to the address <tt>http://have_access_to/myalerts.shtml</tt>
            and fill in your email address, the password &#8220;abcde&#8221;,
            how often &#8220;daily&#8221; and choose one of the filters</p></li><li><p>Click on Send, a message &#8220;success: insert&#8221;
            appears. You may change your settings and use Send again.</p></li><li><p>Confirm your subscription: Click on the link received in the
            Welcome email</p></li></ol></div></li><li><p>Send alerts:</p><div class="orderedlist"><ol type="a"><li>Go to My Alerts, Send emails. Choose &#8220;daily&#8221;
            and click on &#8220;Go!&#8221; at &#8220;Send example&#8221;.
            You should receive a digest of all items added in the last 24
            hours to your favorite test slice. If there are no such items, add
            some: click on My Selection 1, this moves you to your favorite
            test slice.</li><li>Try the same with &#8220;Send now alerts to all users&#8221;.
            Note this will store the time into the database and if you click
            again on this button, no mail will be sent because no message was
            added between the two runs.</li></ol></div></li><li>Add items to your favorite test slice and test that you
        receive them</li></ol></div></div><div class="sect1"><div class="titlepage"><div><h2 class="title" style="clear: both"><a name="d0e409"></a>Tips</h2></div></div><p><span class="emphasis"><em>Alerts-only reader management: </em></span>You do not need
    the username, but the email is required. Change these Fields settings.
    Perhaps you even do not need to password-protect the reader personal info.
    Change also the &#8220;Allow anonymous posting / editing&#8221; slice
    settings.</p><p><span class="emphasis"><em>Filtering readers who are not yet confirmed: </em></span>Change
    the design of the Item Manager in Slice Admin to show the alias
    <tt>_#MAILCONF</tt>. This alias shows &#8220;yes&#8221; or
    &#8220;no&#8221;. But it is created by the <tt>f_c</tt>
    function and the values in the database are 0 or 1. Thus give
    &#8220;0&#8221; and not &#8220;no&#8221; into the Search box.</p><p><span class="emphasis"><em>Filtering readers receiving a selection:</em></span> Add
    the Alerts Selections to Item Manager. Create an alias using the function
    <tt>f_h</tt> with the parameter <tt>,</tt>
    (comma). You will see the selection IDs prefixed by <tt>f</tt>.
    Now you understand why you should enter something like &#8220;f45&#8221;
    into the Search box.</p></div></div></body></html>